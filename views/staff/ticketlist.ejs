<!DOCTYPE html>
<html>
<%- include('./inc/nav.ejs') %>
<title>Logikk's Dashboard - Revisor de tickets</title>
&nbsp
<body>  
  <div class="container mt-5">
    <% if (typeof noti !== 'undefined' && noti === 'done') { %>
      <div class="alert alert-success">El estado del ticket fue actualizado correctamente.</div>
    <% } %>
    
    <table>
        <thead>
          <tr>
            <th>ID del ticket</th>
            <th>Categoría</th>
            <th>Descripción</th>
            <th>Estado</th>
            <th>Fecha de creación</th>
            <th>Fecha de actualización</th>
            <th>ID del usuario (Discord)</th>
            <th>Cambiar estado del ticket</th> <!-- nueva columna -->
          </tr>
        </thead>
        <tbody>
          <% for (let i = 0; i < tickets.length; i++) { %>
            <tr>
              <td><%= tickets[i].id %></td>
              <td><%= tickets[i].title %></td>
              <td class="categoria"><%= tickets[i].description %></td>
              <td>
                <% if (tickets[i].status === 'abierto') { %>
                  <span style="color: green">Aceptado</span>
                <% } else if (tickets[i].status === 'en progreso') { %>
                  <span style="color: yellow">Aguardando revisión</span>
                <% } else { %>
                  <span style="color: red">Denegado</span>
                <% } %>
              </td>
              <td><%= tickets[i].createdAt %></td>
              <td><%= tickets[i].updatedAt %></td>
              <td><%= tickets[i].discord_id %></td>
              <td>
                <form method="POST" action="/staff/tickets/<%= tickets[i].id %>/update-status">
                  <select name="status">
                    <option value="abierto">Aceptado</option>
                    <option value="cerrado">Denegado</option>
                  </select>
                  <button type="submit">Guardar</button>
                </form>
              </td>
            </tr>
          <% } %>
        </tbody>
      </table>
      
  </div>      
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNVeG6w" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>
<style>
    .categoria {
  max-width: 200px; 
  word-wrap: break-word; 
}
    body {
      background-color: #222;
      color: #fff;
      font-family: sans-serif;
    }
    .navbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #111;
      padding: 10px;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    h1 {
      font-size: 3rem;
      margin-bottom: 0;
    }
    h2 {
      font-size: 2rem;
      margin-top: 0;
      opacity: 0.8;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    th, td {
      text-align: left;
      padding: 8px;
      border-bottom: 1px solid #ddd;
    }
    tr:hover {
      background-color: #444;
    }
    th {
      background-color: #111;
      color: #fff;
    }
    .button {
      display: inline-block;
      background-color: #fff;
      color: #333;
      border: 1px solid #333;
      padding: 8px 16px;
      text-decoration: none;
      border-radius: 4px;
      margin-top: 20px;
    }
    .button:hover {
      background-color: #333;
      color: #fff;
    }
</style>